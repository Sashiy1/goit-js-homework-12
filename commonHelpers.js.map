{"version":3,"file":"commonHelpers.js","sources":["../src/main.js"],"sourcesContent":["import axios from 'axios';\nimport iziToast from 'izitoast';\nimport 'izitoast/dist/css/iziToast.min.css';\nimport SimpleLightbox from 'simplelightbox';\nimport 'simplelightbox/dist/simple-lightbox.min.css';\n\nconst form = document.querySelector('.form');\nconst elementsContainer = document.querySelector('.gallery');\nconst loader = document.querySelector('.loader');\nconst loadButton = document.querySelector('.loading-button');\nconst BASE_URL = 'https://pixabay.com/api/';\nconst queryParams = {\n  query: '',\n  apiKey: '41967229-af64f083e47c21f795887158a',\n  orientation: 'horizontal',\n  image_type: 'photo',\n  safesearch: 'true',\n  per_page: 20,\n  page: 1,\n};\nconst lightbox = new SimpleLightbox('.gallery-item a', {\n  captionsData: 'alt',\n  captionDelay: 250,\n});\n\n\nform.addEventListener('submit', handleSubmit);\n\nasync function handleSubmit(event) {\n  event.preventDefault();\n  elementsContainer.innerHTML = '';\n  queryParams.page = 1;\n  queryParams.query = event.currentTarget.elements.serching.value.trim();\n  loader.classList.remove('hidden');\n  if (!queryParams.query && queryParams.query !== '') {\n    return;\n\n  }\n  try {\n    const { hits, totalHits } = await searchPictures(queryParams);\n    queryParams.maxPage = Math.ceil(totalHits / queryParams.per_page);\n    createMarkup(hits, totalHits);\n    \n    loader.classList.add('hidden');\n\n    if (hits.length > 0 && hits.length !== totalHits) {\n      show(loadButton);\n      loadButton.addEventListener(\"click\", handleLoading);\n\n    } else {\n      iziToast.show({\n        message:\n          'Sorry, there are no images matching your search query. Please try again!',\n        position: 'topRight',\n        backgroundColor: '#EF4040',\n        titleColor: '#FFFFFF',\n        messageColor: '#FFFFFF',\n      });\n      hide(loadButton);\n\n    }\n  } catch (error) {\n    console.log(error);\n\n  \n  } finally {\n    form.reset();\n\n  }\n}\n\nasync function searchPictures({ query, page = 1, per_page }) {\n  return await axios\n    .get(`${BASE_URL}`, {\n      params: {\n        key: '41967229-af64f083e47c21f795887158a',\n        q: query,\n        orientation: 'horizontal',\n        image_type: 'photo',\n        safesearch: 'true',\n        per_page,\n        page,\n      },\n    })\n    .then(({ data }) => data);\n\n}\n\nfunction createMarkup(hits) {\n  const markup = hits.map(\n    ({\n      webformatURL,\n      largeImageURL,\n      tags,\n      likes,\n      views,\n      comments,\n      downloads,\n    }) =>\n      `<li class=\"gallery-item\">\n         <a class=\"gallery-link\" href=\"${largeImageURL}\">\n         <img class=\"gallery-image\"\n         src=\"${webformatURL}\"\n         alt=\"${tags}\" /></a>\n         <container class=\"details-container\">\n         <div class=\"details\">\n         <h3 class=\"details-title\">Likes</h3>\n         <p class=\"details-text\">${likes}</p>\n         </div>\n         <div class=\"details\">\n         <h3 class=\"details-title\">Views</h3>\n         <p class=\"details-text\">${views}</p>\n         </div>\n         <div class=\"details\">\n         <h3 class=\"details-title\">Comments</h3>\n        <p class=\"details-text\">${comments}</p>\n        </div>\n        <div class=\"details\">\n        <h3 class=\"details-title\">Downloads</h3>\n        <p class=\"details-text\">${downloads}</p>\n        </div></container> \n        </li>`\n  );\n  elementsContainer.insertAdjacentHTML('beforeend', markup);\n\n\n  lightbox.refresh();\n  \n}\n\nasync function handleLoading() {\n  queryParams.page += 1;\n  disable();\n\n  try {\n    const { hits } = await searchPictures(queryParams); // робимо запит на наступну сторінку новин\n    createMarkup(hits)\n    const galleryItem = document.querySelector('.gallery-item')\n    const rect = galleryItem.getBoundingClientRect();\n    window.scrollBy({\n      top: rect.height * 2,\n\n      behavior: \"smooth\",\n    });\n  } catch (err) {\n    console.log(err);\n  } finally {\n    enable()\n    if (queryParams.page === queryParams.maxPage) {\n      hide();\n      loadButton.removeEventListener(\"click\", handleLoading);\n    }\n  }\n\n}\n\nfunction hide() {\n  loadButton.classList.add('hidden');\n}\n\nfunction show() {\n  loadButton.classList.remove('hidden');\n}\n\nfunction enable() {\n  loader.classList.add('hidden');\n  loadButton.disabled = false;\n}\n\nfunction disable() {\n  loader.classList.remove('hidden');\n  loadButton.disabled = true;\n}\n"],"names":["form","elementsContainer","loader","loadButton","BASE_URL","queryParams","lightbox","SimpleLightbox","handleSubmit","event","hits","totalHits","searchPictures","createMarkup","show","handleLoading","iziToast","hide","error","query","page","per_page","axios","data","markup","webformatURL","largeImageURL","tags","likes","views","comments","downloads","disable","rect","err","enable"],"mappings":"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"}