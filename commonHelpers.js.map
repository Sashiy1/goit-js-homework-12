{"version":3,"file":"commonHelpers.js","sources":["../src/main.js"],"sourcesContent":["import axios from 'axios';\nimport iziToast from 'izitoast';\nimport 'izitoast/dist/css/iziToast.min.css';\nimport SimpleLightbox from 'simplelightbox';\nimport 'simplelightbox/dist/simple-lightbox.min.css';\n\nconst form = document.querySelector('.form');\nconst elementsContainer = document.querySelector('.gallery');\nconst loader = document.querySelector('.loader');\nconst loadButton = document.querySelector('.loading-button');\nconst BASE_URL = 'https://pixabay.com/api/';\nconst queryParams = {\n  query: '',\n  apiKey: '41967229-af64f083e47c21f795887158a',\n  orientation: 'horizontal',\n  image_type: 'photo',\n  safesearch: 'true',\n  per_page: 40,\n  page: 1,\n};\nconst lightbox = new SimpleLightbox('.gallery-item a', {\n  captionsData: 'alt',\n  captionDelay: 250,\n});\n\nform.addEventListener('submit', handleSubmit);\n\nasync function handleSubmit(event) {\n  event.preventDefault();\n  elementsContainer.innerHTML = '';\n  queryParams.page = 1;\n  queryParams.query = event.currentTarget.elements.serching.value.trim();\n\n  if (!queryParams.query) {\n    return;\n  }\n  try {\n    const { hits, totalHits } = await searchPictures(queryParams);\n\n    queryParams.maxPage = Math.ceil(totalHits / queryParams.per_page);\n\n    console.log({ hits, totalHits });\n    createMarkup(hits, totalHits);\n    console.log(queryParams.maxPage);\n    if (hits.length > 0 && hits.length !== totalHits) {\n      show(loadButton);\n      loadButton.addEventListener(\"click\", handleLoading);\n    } else {\n      hide(loadButton);\n    }\n  } catch (error) {\n    console.log(error);\n  } finally {\n    form.reset();\n  }\n}\n\nasync function searchPictures({ query, page = 1, per_page }) {\n  return await axios\n    .get(`${BASE_URL}`, {\n      params: {\n        key: '41967229-af64f083e47c21f795887158a',\n        q: query,\n        orientation: 'horizontal',\n        image_type: 'photo',\n        safesearch: 'true',\n        per_page,\n        page,\n      },\n    })\n    .then(({ data }) => data);\n}\n\nfunction createMarkup(hits) {\n  const markup = hits.map(\n    ({\n      webformatURL,\n      largeImageURL,\n      tags,\n      likes,\n      views,\n      comments,\n      downloads,\n    }) =>\n      `<li class=\"gallery-item\">\n         <a class=\"gallery-link\" href=\"${largeImageURL}\">\n         <img class=\"gallery-image\"\n         src=\"${webformatURL}\"\n         alt=\"${tags}\" /></a>\n         <container class=\"details-container\">\n         <div class=\"details\">\n         <h3 class=\"details-title\">Likes</h3>\n         <p class=\"details-text\">${likes}</p>\n         </div>\n         <div class=\"details\">\n         <h3 class=\"details-title\">Views</h3>\n         <p class=\"details-text\">${views}</p>\n         </div>\n         <div class=\"details\">\n         <h3 class=\"details-title\">Comments</h3>\n        <p class=\"details-text\">${comments}</p>\n        </div>\n        <div class=\"details\">\n        <h3 class=\"details-title\">Downloads</h3>\n        <p class=\"details-text\">${downloads}</p>\n        </div></container> \n        </li>`\n  );\n  elementsContainer.insertAdjacentHTML('beforeend', markup);\n}\n\n\nasync function handleLoading() {\n  queryParams.page += 1;\n  disable();\n\n\n  try {\n    const { hits } = await searchPictures(queryParams); // робимо запит на наступну сторінку новин\n    createMarkup(hits)\n  \n\n  } catch (err) {\n    console.log(err);\n  } finally {\n    enable()\n    if (queryParams.page === queryParams.maxPage) {\n      hide();\n      loadButton.removeEventListener(\"click\", handleLoading);\n    }\n  }\n\n\n}\n\n\n\n// function onError() {\n//   loader.classList.add('hidden');\n//   elementsContainer.innerHTML = '';\n//   iziToast.show({\n//     message:\n//       'Sorry, there are no images matching your search query. Please try again!',\n//     position: 'topRight',\n//     backgroundColor: '#EF4040',\n//     titleColor: '#FFFFFF',\n//     messageColor: '#FFFFFF',\n//   });\n// }\n\nfunction hide() {\n  loadButton.classList.add('hidden');\n}\n\nfunction show() {\n  loadButton.classList.remove('hidden');\n}\n\nfunction enable() {\n  loader.classList.add('hidden');\n  loadButton.disabled = false;\n}\n\nfunction disable() {\n  loader.classList.remove('hidden');\n  loadButton.disabled = true;\n}\n"],"names":["form","elementsContainer","loader","loadButton","BASE_URL","queryParams","SimpleLightbox","handleSubmit","event","hits","totalHits","searchPictures","createMarkup","show","handleLoading","hide","error","query","page","per_page","axios","data","markup","webformatURL","largeImageURL","tags","likes","views","comments","downloads","disable","err","enable"],"mappings":"6vBAMA,MAAMA,EAAO,SAAS,cAAc,OAAO,EACrCC,EAAoB,SAAS,cAAc,UAAU,EACrDC,EAAS,SAAS,cAAc,SAAS,EACzCC,EAAa,SAAS,cAAc,iBAAiB,EACrDC,EAAW,2BACXC,EAAc,CAClB,MAAO,GACP,OAAQ,qCACR,YAAa,aACb,WAAY,QACZ,WAAY,OACZ,SAAU,GACV,KAAM,CACR,EACiB,IAAIC,EAAe,kBAAmB,CACrD,aAAc,MACd,aAAc,GAChB,CAAC,EAEDN,EAAK,iBAAiB,SAAUO,CAAY,EAE5C,eAAeA,EAAaC,EAAO,CAMjC,GALAA,EAAM,eAAc,EACpBP,EAAkB,UAAY,GAC9BI,EAAY,KAAO,EACnBA,EAAY,MAAQG,EAAM,cAAc,SAAS,SAAS,MAAM,OAE5D,EAACH,EAAY,MAGjB,GAAI,CACF,KAAM,CAAE,KAAAI,EAAM,UAAAC,CAAS,EAAK,MAAMC,EAAeN,CAAW,EAE5DA,EAAY,QAAU,KAAK,KAAKK,EAAYL,EAAY,QAAQ,EAEhE,QAAQ,IAAI,CAAE,KAAAI,EAAM,UAAAC,CAAW,CAAA,EAC/BE,EAAaH,EAAMC,CAAS,EAC5B,QAAQ,IAAIL,EAAY,OAAO,EAC3BI,EAAK,OAAS,GAAKA,EAAK,SAAWC,GACrCG,EAAKV,CAAU,EACfA,EAAW,iBAAiB,QAASW,CAAa,GAElDC,EAAKZ,CAAU,CAElB,OAAQa,EAAP,CACA,QAAQ,IAAIA,CAAK,CACrB,QAAY,CACRhB,EAAK,MAAK,CACX,CACH,CAEA,eAAeW,EAAe,CAAE,MAAAM,EAAO,KAAAC,EAAO,EAAG,SAAAC,CAAQ,EAAI,CAC3D,OAAO,MAAMC,EACV,IAAI,GAAGhB,IAAY,CAClB,OAAQ,CACN,IAAK,qCACL,EAAGa,EACH,YAAa,aACb,WAAY,QACZ,WAAY,OACZ,SAAAE,EACA,KAAAD,CACD,CACP,CAAK,EACA,KAAK,CAAC,CAAE,KAAAG,CAAM,IAAKA,CAAI,CAC5B,CAEA,SAAST,EAAaH,EAAM,CAC1B,MAAMa,EAASb,EAAK,IAClB,CAAC,CACC,aAAAc,EACA,cAAAC,EACA,KAAAC,EACA,MAAAC,EACA,MAAAC,EACA,SAAAC,EACA,UAAAC,CACD,IACC;AAAA,yCACmCL;AAAA;AAAA,gBAEzBD;AAAA,gBACAE;AAAA;AAAA;AAAA;AAAA,mCAImBC;AAAA;AAAA;AAAA;AAAA,mCAIAC;AAAA;AAAA;AAAA;AAAA,kCAIDC;AAAA;AAAA;AAAA;AAAA,kCAIAC;AAAA;AAAA,cAGlC,EACE5B,EAAkB,mBAAmB,YAAaqB,CAAM,CAC1D,CAGA,eAAeR,GAAgB,CAC7BT,EAAY,MAAQ,EACpByB,IAGA,GAAI,CACF,KAAM,CAAE,KAAArB,CAAM,EAAG,MAAME,EAAeN,CAAW,EACjDO,EAAaH,CAAI,CAGlB,OAAQsB,EAAP,CACA,QAAQ,IAAIA,CAAG,CACnB,QAAY,CACRC,EAAQ,EACJ3B,EAAY,OAASA,EAAY,UACnCU,IACAZ,EAAW,oBAAoB,QAASW,CAAa,EAExD,CAGH,CAiBA,SAASC,GAAO,CACdZ,EAAW,UAAU,IAAI,QAAQ,CACnC,CAEA,SAASU,GAAO,CACdV,EAAW,UAAU,OAAO,QAAQ,CACtC,CAEA,SAAS6B,GAAS,CAChB9B,EAAO,UAAU,IAAI,QAAQ,EAC7BC,EAAW,SAAW,EACxB,CAEA,SAAS2B,GAAU,CACjB5B,EAAO,UAAU,OAAO,QAAQ,EAChCC,EAAW,SAAW,EACxB"}